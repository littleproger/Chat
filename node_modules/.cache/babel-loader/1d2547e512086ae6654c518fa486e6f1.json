{"ast":null,"code":"import _toConsumableArray from\"/home/yarik/Documents/binary/react-stage1/part1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _classCallCheck from\"/home/yarik/Documents/binary/react-stage1/part1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/yarik/Documents/binary/react-stage1/part1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/yarik/Documents/binary/react-stage1/part1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/yarik/Documents/binary/react-stage1/part1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Header from\"./Header\";import MessageList from\"./MessageList\";import MessageInput from\"./MessageInput\";import Spiner from\"../animatedElem/Spiner\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Chat=/*#__PURE__*/function(_Component){_inherits(Chat,_Component);var _super=_createSuper(Chat);function Chat(props){var _this;_classCallCheck(this,Chat);_this=_super.call(this,props);_this.changeHeader=function(){var allUserId=_this.state.messages.map(function(msg){return msg.userId;});var messagesLength=_this.state.messages.length;var users=new Set(allUserId);var createdAt=new Date(_this.state.messages[messagesLength-1].createdAt).toLocaleDateString().split('.');var today=new Date().toLocaleDateString().split('.');var lastMsgTime=createdAt.join('.').slice(0,5);if(createdAt[2]!==today[2]){lastMsgTime=createdAt.join('.');}_this.setState({roomInform:{roomName:\"My chat\",numberMessages:messagesLength,numberUsers:users.size,lastMessageDate:lastMsgTime}});};_this.addNewMessage=function(data){var myInform=_this.state.myInform;var message={id:data.id,userId:myInform.userId,avatar:myInform.avatar,user:myInform.user,text:data.text,createdAt:data.createdAt,editedAt:\"\"};_this.setState({messages:[].concat(_toConsumableArray(_this.state.messages),[message])});setTimeout(function(){_this.changeHeader();},0);};_this.deleteMessage=function(id){_this.setState({messages:_this.state.messages.filter(function(message){return message.id!==id;})});setTimeout(function(){_this.changeHeader();},0);};_this.editMessage=function(_ref){var id=_ref.id,text=_ref.text;_this.setState({messages:_this.state.messages.map(function(message){if(message.id===id){message.text=text;message.editedAt=new Date().toString();}return message;}),edtMsg:{id:\"\",editMsg:false,text:\"\"}});};_this.clickToEdit=function(id){var text=_this.state.messages.filter(function(message){return message.id===id;});_this.setState({edtMsg:{id:id,editMsg:true,text:text}});};_this.state={roomInform:{roomName:\"My chat\",numberUsers:0,numberMessages:0,lastMessageDate:\"0\"},messages:[],myInform:{userId:\"61325\",avatar:\"https://resizing.flixster.com/EVAkglctn7E9B0hVKJrueplabuQ=/220x196/v1.cjs0NjYwNjtqOzE4NDk1OzEyMDA7MjIwOzE5Ng\",user:\"Wendy\"},edtMsg:{id:\"\",editMsg:false,text:\"\"}};return _this;}_createClass(Chat,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch(\"https://edikdolynskyi.github.io/react_sources/messages.json\").then(function(response){return response.json();}).then(function(data){_this2.setState({messages:data});_this2.changeHeader();});}},{key:\"render\",value:function render(){var data=this.state;return/*#__PURE__*/_jsxs(\"div\",{className:\"pad-lr_chat\",children:[/*#__PURE__*/_jsx(Header,{roomInfo:data.roomInform}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-messageWndw marg-t_20px\",children:data.messages.length!==0?/*#__PURE__*/_jsx(MessageList,{messages:data.messages,myId:data.myInform.userId,deleteMessage:this.deleteMessage,clickToEdit:this.clickToEdit}):/*#__PURE__*/_jsx(Spiner,{})}),this.state.edtMsg.editMsg?/*#__PURE__*/_jsx(MessageInput,{edtMsg:this.state.edtMsg,editMessage:this.editMessage}):/*#__PURE__*/_jsx(MessageInput,{addMessage:this.addNewMessage})]});}}]);return Chat;}(Component);export default Chat;","map":{"version":3,"sources":["/home/yarik/Documents/binary/react-stage1/part1/src/components/Chat/Chat.js"],"names":["React","Component","Header","MessageList","MessageInput","Spiner","Chat","props","changeHeader","allUserId","state","messages","map","msg","userId","messagesLength","length","users","Set","createdAt","Date","toLocaleDateString","split","today","lastMsgTime","join","slice","setState","roomInform","roomName","numberMessages","numberUsers","size","lastMessageDate","addNewMessage","data","myInform","message","id","avatar","user","text","editedAt","setTimeout","deleteMessage","filter","editMessage","toString","edtMsg","editMsg","clickToEdit","fetch","then","response","json"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Header from \"./Header\";\nimport MessageList from \"./MessageList\";\nimport MessageInput from \"./MessageInput\";\nimport Spiner from \"../animatedElem/Spiner\";\n\nclass Chat extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      roomInform: {\n        roomName: \"My chat\",\n        numberUsers: 0,\n        numberMessages: 0,\n        lastMessageDate: \"0\",\n      },\n      messages: [],\n      myInform: {\n        userId: \"61325\",\n        avatar:\n          \"https://resizing.flixster.com/EVAkglctn7E9B0hVKJrueplabuQ=/220x196/v1.cjs0NjYwNjtqOzE4NDk1OzEyMDA7MjIwOzE5Ng\",\n        user: \"Wendy\",\n      },\n      edtMsg: {\n        id: \"\",\n        editMsg: false,\n        text: \"\",\n      },\n    };\n  }\n\n  componentDidMount() {\n    fetch(\"https://edikdolynskyi.github.io/react_sources/messages.json\")\n      .then((response) => response.json())\n      .then((data) => {\n        this.setState({\n          messages: data,\n        });\n        this.changeHeader();\n      });\n  }\n\n  changeHeader = () => {\n    const allUserId = this.state.messages.map((msg) => {\n      return msg.userId;\n    });\n\n    const messagesLength = this.state.messages.length;\n    const users = new Set(allUserId);\n\n    const createdAt = new Date(\n      this.state.messages[messagesLength - 1].createdAt\n    ).toLocaleDateString().split('.');\n    const today = new Date().toLocaleDateString().split('.');\n\n    let lastMsgTime = createdAt.join('.').slice(0,5);\n    if (createdAt[2] !== today[2]){\n      lastMsgTime = createdAt.join('.');\n    }\n\n    this.setState({\n      roomInform: {\n        roomName: \"My chat\",\n        numberMessages: messagesLength,\n        numberUsers: users.size,\n        lastMessageDate: lastMsgTime\n      },\n    });\n  };\n\n  addNewMessage = (data) => {\n    const myInform = this.state.myInform;\n    const message = {\n      id: data.id,\n      userId: myInform.userId,\n      avatar: myInform.avatar,\n      user: myInform.user,\n      text: data.text,\n      createdAt: data.createdAt,\n      editedAt: \"\",\n    };\n    this.setState({\n      messages: [...this.state.messages, message],\n    });\n    setTimeout(() => {\n      this.changeHeader();\n    }, 0);\n  };\n\n  deleteMessage = (id) => {\n    this.setState({\n      messages: this.state.messages.filter((message) => {\n        return message.id !== id;\n      }),\n    });\n    setTimeout(() => {\n      this.changeHeader();\n    }, 0);\n  };\n\n  editMessage = ({ id, text }) => {\n    this.setState({\n      messages: this.state.messages.map((message) => {\n        if (message.id === id) {\n          message.text = text;\n          message.editedAt = new Date().toString();\n        }\n        return message;\n      }),\n      edtMsg: {\n        id: \"\",\n        editMsg: false,\n        text: \"\",\n      },\n    });\n  };\n\n  clickToEdit = (id) => {\n    const text = this.state.messages.filter((message) => message.id === id);\n    this.setState({\n      edtMsg: {\n        id,\n        editMsg: true,\n        text,\n      },\n    });\n  };\n\n  render() {\n    const data = this.state;\n    return (\n      <div className=\"pad-lr_chat\">\n        <Header roomInfo={data.roomInform} />\n        <div className=\"chat-messageWndw marg-t_20px\">\n          {data.messages.length !== 0 ? (\n            <MessageList\n              messages={data.messages}\n              myId={data.myInform.userId}\n              deleteMessage={this.deleteMessage}\n              clickToEdit={this.clickToEdit}\n            />\n          ) : (\n            <Spiner />\n          )}\n        </div>\n        {this.state.edtMsg.editMsg ? (\n          <MessageInput\n            edtMsg={this.state.edtMsg}\n            editMessage={this.editMessage}\n          />\n        ) : (\n          <MessageInput addMessage={this.addNewMessage} />\n        )}\n      </div>\n    );\n  }\n}\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}