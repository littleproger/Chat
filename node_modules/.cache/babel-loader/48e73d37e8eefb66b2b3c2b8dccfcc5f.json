{"ast":null,"code":"import { ADD_NEW_MESSAGE, FETCHED_MESSAGES, DELETE_MESSAGE, SHOW_EDIT, HIDE_EDIT, EDIT_MESSAGE } from \"../actions/actionsType\";\nconst initialState = {\n  messages: [],\n  myInform: {\n    userId: \"61325\",\n    avatar: \"https://resizing.flixster.com/EVAkglctn7E9B0hVKJrueplabuQ=/220x196/v1.cjs0NjYwNjtqOzE4NDk1OzEyMDA7MjIwOzE5Ng\",\n    user: \"Yaroslav\"\n  },\n  editMsg: {\n    id: \"\",\n    editMsg: false,\n    text: \"\"\n  }\n};\nexport function messageReducer(state = initialState, action) {\n  switch (action.type) {\n    case ADD_NEW_MESSAGE:\n      const message = {\n        id: action.payload.id,\n        userId: state.myInform.userId,\n        avatar: state.myInform.avatar,\n        user: state.myInform.user,\n        text: action.payload.text,\n        createdAt: action.payload.createdAt,\n        editedAt: \"\"\n      };\n      return { ...state,\n        messages: [...state.messages, message]\n      };\n\n    case FETCHED_MESSAGES:\n      return { ...state,\n        messages: [...state.messages, ...action.payload]\n      };\n\n    case DELETE_MESSAGE:\n      return { ...state,\n        messages: state.messages.filter(message => message.id !== action.payload)\n      };\n\n    case SHOW_EDIT:\n      console.log(action.payload);\n\n      if (action.payload) {\n        const text = state.messages.filter(message => message.id === action.payload);\n        return { ...state,\n          editMsg: {\n            id: action.payload,\n            editMsg: true,\n            text: text[0].text\n          }\n        };\n      } else {\n        const myMessage = state.messages.map(message => state.myInform.userId === message.userId);\n        const lastMessage = myMessage[myMessage.length - 1];\n        console.log(lastMessage);\n\n        if (lastMessage) {\n          return { ...state,\n            editMsg: {\n              id: lastMessage.id,\n              editMsg: true,\n              text: lastMessage.text\n            }\n          };\n        } else {}\n\n        ;\n      }\n\n    case HIDE_EDIT:\n      return { ...state,\n        editMsg: {\n          id: \"\",\n          editMsg: false,\n          text: \"\"\n        }\n      };\n\n    case EDIT_MESSAGE:\n      return { ...state,\n        messages: state.messages.map(message => {\n          if (message.id === action.payload.id) {\n            message.text = action.payload.text;\n            message.editedAt = new Date().toString();\n          }\n\n          return message;\n        })\n      };\n\n    default:\n      return state;\n  }\n}","map":{"version":3,"sources":["/home/yarik/Documents/binary/react-stage1/part2/src/components/reducers/messageReducer.js"],"names":["ADD_NEW_MESSAGE","FETCHED_MESSAGES","DELETE_MESSAGE","SHOW_EDIT","HIDE_EDIT","EDIT_MESSAGE","initialState","messages","myInform","userId","avatar","user","editMsg","id","text","messageReducer","state","action","type","message","payload","createdAt","editedAt","filter","console","log","myMessage","map","lastMessage","length","Date","toString"],"mappings":"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","sourcesContent":["import {\n  ADD_NEW_MESSAGE,\n  FETCHED_MESSAGES,\n  DELETE_MESSAGE,\n  SHOW_EDIT,\n  HIDE_EDIT,\n  EDIT_MESSAGE,\n} from \"../actions/actionsType\";\nconst initialState = {\n  messages: [],\n  myInform: {\n    userId: \"61325\",\n    avatar:\n      \"https://resizing.flixster.com/EVAkglctn7E9B0hVKJrueplabuQ=/220x196/v1.cjs0NjYwNjtqOzE4NDk1OzEyMDA7MjIwOzE5Ng\",\n    user: \"Yaroslav\",\n  },\n  editMsg: {\n    id: \"\",\n    editMsg: false,\n    text: \"\",\n  },\n};\n\nexport function messageReducer(state = initialState, action) {\n  switch (action.type) {\n    case ADD_NEW_MESSAGE:\n      const message = {\n        id: action.payload.id,\n        userId: state.myInform.userId,\n        avatar: state.myInform.avatar,\n        user: state.myInform.user,\n        text: action.payload.text,\n        createdAt: action.payload.createdAt,\n        editedAt: \"\",\n      };\n      return { ...state, messages: [...state.messages, message] };\n\n    case FETCHED_MESSAGES:\n      return { ...state, messages: [...state.messages, ...action.payload] };\n\n    case DELETE_MESSAGE:\n      return {\n        ...state,\n        messages: state.messages.filter(\n          (message) => message.id !== action.payload\n        ),\n      };\n\n    case SHOW_EDIT:\n    console.log(action.payload)\n      if (action.payload) {\n        const text = state.messages.filter(\n          (message) => message.id === action.payload\n        );\n        return {\n          ...state,\n          editMsg: { id:action.payload, editMsg: true, text: text[0].text }\n        };\n      } else {\n        const myMessage = state.messages.map((message)=>state.myInform.userId === message.userId);\n        const lastMessage = myMessage[myMessage.length-1];\n        console.log(lastMessage)\n        if(lastMessage){\n          return {\n          ...state,\n          editMsg: { id:lastMessage.id, editMsg: true, text: lastMessage.text }\n        };\n        }else{\n\n        };\n      }\n\n    case HIDE_EDIT:\n      return { ...state, editMsg: { id: \"\", editMsg: false, text: \"\" } };\n\n    case EDIT_MESSAGE:\n      return {\n        ...state,\n        messages: state.messages.map((message) => {\n          if (message.id === action.payload.id) {\n            message.text = action.payload.text;\n            message.editedAt = new Date().toString();\n          }\n          return message;\n        }),\n      };\n\n    default:\n      return state;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}